<!-- BookSwap -->

<!DOCTYPE HTML>

<html>
<header>
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
  <title> Drexel BookSwap </title>
  <!-- include jQuery -->
  <script src='http://code.jquery.com/jquery-3.1.0.js'></script>
  <script language='javascript'>
    function argObj(_name, _val){
      this.name = _name
      this.val  = _val
    }

    // Launch general GET request
    // input:  endpoint (string), callback (function(arg)), argObjs...
    // output: none
    // side-effect: launches asynchronous GET request
    function launchGetReq(){
      if (arguments.length < 2)
        return;

      var doDb = arguments[1]

      var URL
      endpoint = arguments[0]
      if (endpoint == 'search'){
        URL = 'http://localhost:8080/' 
           + endpoint 
           + '?' 
        for (var i = 2 ; i < arguments.length ; i++){
          var obj
          obj = arguments[i]
          if (obj.val.length > 0){
            URL += obj.name + '=' + encodeURIComponent(obj.val)
            if (i != arguments.length - 1)
              URL += '&'
          }
        }
      }
      else{
        console.log('bad endpoint: ' + endpoint)
        return
      }

      $.ajax({
           type: 'GET', 
           url : URL, 
           success: function(msg){
                      console.log('launchGetReq success')
                      doCb(msg)
                    }, 
           error: function(jgXHR, textStatus, errorThrown){
                    console.log('launchGetReq error')
                    alert('Error: ' + textStatus + '\n' + errorThrown)
                  }
          })
    }

    function dumbCb(arg){
      /* dumb */
    }

    function doSearch(){
      var title  = new argObj('title', $('#searchInp_title' ).val())
      var author = new argObj('author', $('#searchInp_author' ).val())
      var isbn   = new argObj('isbn', $('#searchInp_isbn' ).val())

      launchGetReq('search', dumbCb, title, author, isbn)
    }

    function wrapClick(ev){
      ev.preventDefault()
      doSearch()
    }

    function wrapKeyup(ev){
      ev.preventDefault()
      if (ev.keyCode == 13) // enter
        $('#searchBtn').click()
    }
  </script>

</header>
  <body>
    <h3> What is BookSwap? </h3>
      BookSwap is what you've wanted for a long time now: a centralized
      spot for swappin' text! Cancel that online order, burn your library
      card - reading's free from now on.

    <br><br>
    <a href='./login.html'  > User Login </a> <br>
    <a href='./profile.html'> My Profile </a> 
    <br><br>
    <!-- input box and button -->
    <input type='text' id='searchInp_title'  placeholder='Title'/>
    <input type='text' id='searchInp_author' placeholder='Author'/>
    <input type='text' id='searchInp_isbn'   placeholder='ISBN'/>
    <br>
    <button id='searchBtn'> Search! </button> <br>
    <a href='./adv-search.html'> Advanced Search </a> 

    <script>
      $('#searchInp_title' ).keyup(function(ev){ wrapKeyup(ev) })
      $('#searchInp_author').keyup(function(ev){ wrapKeyup(ev) })
      $('#searchInp_isbn'  ).keyup(function(ev){ wrapKeyup(ev) })
      $('#searchBtn').click(function(ev){ wrapClick(ev) })
    </script>
  </body>
</html>
